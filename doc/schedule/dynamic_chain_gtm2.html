<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of dynamic_chain_gtm2</title>
  <meta name="keywords" content="dynamic_chain_gtm2">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html schedule -->
<h1>dynamic_chain_gtm2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="TFDimensionList2cell.html" class="code" title="function [tfd_cell] = TFDimensionList2cell(tfd_list)">TFDimensionList2cell</a>	</li><li><a href="min_backward_message2.html" class="code" title="function [models] = min_backward_message2(models, lastmodel)">min_backward_message2</a>	sends backward (child to parents) message calculating cumulative</li><li><a href="tf_model2.html" class="code" title="">tf_model2</a>	tucker_model</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a href="tf_model2.html" class="code" title="">tf_model2</a>
0002 
0003 all_sequences= <span class="keyword">...</span>
0004     perms(<a href="TFDimensionList2cell.html" class="code" title="function [tfd_cell] = TFDimensionList2cell(tfd_list)">TFDimensionList2cell</a>(tucker_model.get_contraction_dims));
0005 
0006 initmodel = tucker_model;
0007 models = [initmodel];
0008 
0009 <span class="keyword">for</span> s=1:size(all_sequences,1)
0010     parent=1; <span class="comment">% reset parent</span>
0011 
0012     <span class="keyword">for</span> d=1:size(all_sequences,2)
0013         newmodel = models(parent).contract(all_sequences(s,d));
0014 
0015         <span class="comment">% memoization</span>
0016         found=0;
0017         <span class="keyword">for</span> i=1:length(models)
0018             <span class="keyword">if</span> models(i) == newmodel
0019                 found=i;
0020                 <span class="keyword">break</span>;
0021             <span class="keyword">end</span>
0022         <span class="keyword">end</span>
0023 
0024         <span class="keyword">if</span> found == 0
0025             newmodel.parent_tree_indices = [parent];
0026             newmodel.cost = newmodel.get_element_size;
0027             models = [models newmodel];
0028             models(parent).children_tree_indices = <span class="keyword">...</span>
0029                 [ models(parent).children_tree_indices length(models) ];
0030 
0031             parent = length(models);
0032 
0033             <span class="comment">% mark last model for backward message</span>
0034             <span class="keyword">if</span> length(newmodel.get_current_contraction_dims) == 0
0035                 lastmodel = length(models);
0036             <span class="keyword">end</span>
0037 
0038         <span class="keyword">else</span>
0039             <span class="keyword">if</span> sum( models(found).parent_tree_indices == parent ) == 0
0040                 models(found).parent_tree_indices = <span class="keyword">...</span>
0041                     [ models(found).parent_tree_indices parent ];
0042 
0043                 models(parent).children_tree_indices = <span class="keyword">...</span>
0044                     [ models(parent).children_tree_indices found ];
0045             <span class="keyword">end</span>
0046 
0047             parent = found;
0048         <span class="keyword">end</span>
0049     <span class="keyword">end</span>
0050 <span class="keyword">end</span>
0051 
0052 
0053 
0054 
0055 
0056 
0057 
0058 
0059 <span class="comment">% calculate cumulative costs</span>
0060 models=<a href="min_backward_message2.html" class="code" title="function [models] = min_backward_message2(models, lastmodel)">min_backward_message2</a>(models, [lastmodel]);
0061 
0062 s=1;
0063 global_min_path=[];
0064 <span class="keyword">while</span> s~=lastmodel
0065     costs=[];
0066     inds=[];
0067     <span class="keyword">for</span> i = 1:length(models(s).children_tree_indices)
0068         costs = [costs models(models(s).children_tree_indices(i)).cost];
0069         inds = [inds models(s).children_tree_indices(i)];
0070     <span class="keyword">end</span>
0071 
0072     global_min_path = [global_min_path inds(find(costs == <span class="keyword">...</span>
0073                                                  min(costs)))];
0074     s=s+1;
0075 <span class="keyword">end</span>
0076 
0077 
0078 
0079 p=<span class="string">'[], '</span>;
0080 
0081 <span class="keyword">for</span> s=2:length(models)
0082     p = [ p <span class="string">'[ '</span> ];
0083     <span class="keyword">for</span> i =1:length(models(s).parent_tree_indices)
0084         <span class="keyword">if</span> i ~= 1
0085             p = [ p <span class="string">','</span> ];
0086         <span class="keyword">end</span>
0087         p = [ p num2str(models(s).parent_tree_indices(i)) ];
0088     <span class="keyword">end</span>
0089     p = [ p <span class="string">' ] '</span> ];
0090     <span class="keyword">if</span> s ~= length(models)
0091         p = [ p <span class="string">' , '</span> ];
0092     <span class="keyword">end</span>
0093 <span class="keyword">end</span>
0094 
0095 
0096 l=<span class="string">''</span>;
0097 c=<span class="string">''</span>;
0098 <span class="keyword">for</span> s=1:length(models)
0099     <span class="keyword">if</span> s ~= 1
0100         l = [ l <span class="string">','</span> ];
0101         c = [ c <span class="string">','</span> ];
0102     <span class="keyword">end</span>
0103 
0104 
0105     <span class="keyword">if</span> length(models(s).get_current_contraction_dims) == 0
0106         l = [ l <span class="string">' '''' '</span> ];
0107     <span class="keyword">else</span>
0108         l = [ l <span class="string">' '''</span> <span class="keyword">...</span>
0109               char(models(s).get_current_contraction_dims())' <span class="string">''''</span> <span class="keyword">...</span>
0110             ];
0111     <span class="keyword">end</span>
0112 
0113     c=[c num2str(models(s).cost) ];
0114 <span class="keyword">end</span>
0115 
0116 
0117 g=<span class="string">''</span>;
0118 <span class="keyword">for</span> i=1:length(global_min_path)
0119     <span class="keyword">if</span> i ~= 1
0120         g = [ g <span class="string">','</span>];
0121     <span class="keyword">end</span>
0122     g = [g num2str(global_min_path(i))];
0123 <span class="keyword">end</span>
0124 
0125 
0126 system([<span class="string">'python treeplot.py &quot;['</span> p <span class="string">']&quot; &quot;['</span> l <span class="string">']&quot; &quot;['</span> c <span class="string">']&quot; &quot;['</span> g <span class="string">']&quot;'</span> ]);</pre></div>
<hr><address>Generated on Tue 10-Jul-2012 08:47:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>