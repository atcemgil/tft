<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of TFGraph</title>
  <meta name="keywords" content="TFGraph">
  <meta name="description" content="Represents a graph of TFModel objects.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html tft -->
<h1>TFGraph
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Represents a graph of TFModel objects.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Represents a graph of TFModel objects. 

   TFModel.schedule_dp() function generates trees of TFModel
   objects. TFGraph object stores generated TFModel objects in its
   node_list array and stores connectivity information in its
   edges half full binary matrix. Cost of moving along an edge is
   stored in the optimal_edges matrix.

   See also <a href="TFModel.html" class="code" title="">TFModel</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="TFGraph.html" class="code" title="">TFGraph</a>	Represents a graph of TFModel objects.</li><li><a href="TFModel.html" class="code" title="">TFModel</a>	Represents data required to describe a tensor factorization model</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="TFGraph.html" class="code" title="">TFGraph</a>	Represents a graph of TFModel objects.</li><li><a href="TFModel.html" class="code" title="">TFModel</a>	Represents data required to describe a tensor factorization model</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [r] = exists(obj, tfmodel)</a></li><li><a href="#_sub2" class="code">function [obj] = clear_edges(obj)</a></li><li><a href="#_sub3" class="code">function [obj] = increment_edges(obj)</a></li><li><a href="#_sub4" class="code">function [m] = get_min_arriving_cost(obj, node_index)</a></li><li><a href="#_sub5" class="code">function [obj] = append_node(obj, parent_node, new_node)</a></li><li><a href="#_sub6" class="code">function [obj] = update_node(obj, parent_node, child_node,</a></li><li><a href="#_sub7" class="code">function [str] = get_factor_dim_string(obj,</a></li><li><a href="#_sub8" class="code">function [str] = get_current_contraction_dims_string(obj,</a></li><li><a href="#_sub9" class="code">function [str] = print_dot(obj)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% Represents a graph of TFModel objects.</span>
0002 <span class="comment">%</span>
0003 <span class="comment">%   TFModel.schedule_dp() function generates trees of TFModel</span>
0004 <span class="comment">%   objects. TFGraph object stores generated TFModel objects in its</span>
0005 <span class="comment">%   node_list array and stores connectivity information in its</span>
0006 <span class="comment">%   edges half full binary matrix. Cost of moving along an edge is</span>
0007 <span class="comment">%   stored in the optimal_edges matrix.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%   See also TFModel</span>
0010 
0011 classdef <a href="TFGraph.html" class="code" title="">TFGraph</a>
0012 
0013     properties
0014         node_list = <a href="TFModel.html" class="code" title="">TFModel</a>(); <span class="comment">% list TFModel objects</span>
0015         edges;     <span class="comment">% half full binary matrix of node_list relations</span>
0016 
0017         optimal_edges <span class="comment">% half full minimal cost node_list edges</span>
0018     <span class="keyword">end</span>
0019 
0020     methods
0021         <a name="_sub0" href="#_subfunctions" class="code">function [r] = exists(obj, tfmodel)</a>
0022         <span class="comment">% returns index of given node</span>
0023         <span class="comment">% returns 0 if node does not exist</span>
0024             r = 0;
0025             <span class="keyword">for</span> nli = 1:length(obj.node_list)
0026                 <span class="keyword">if</span> obj.node_list(nli) == tfmodel
0027                     r = nli;
0028                     <span class="keyword">return</span>
0029                 <span class="keyword">end</span>
0030             <span class="keyword">end</span>
0031         <span class="keyword">end</span>
0032 
0033 
0034         <a name="_sub1" href="#_subfunctions" class="code">function [obj] = clear_edges(obj)</a>
0035             obj.edges = zeros(length(obj.node_list));
0036             obj.optimal_edges = zeros(length(obj.node_list));
0037         <span class="keyword">end</span>
0038 
0039         <a name="_sub2" href="#_subfunctions" class="code">function [obj] = increment_edges(obj)</a>
0040         <span class="comment">% extend relationship matrices</span>
0041             obj.edges = [ obj.edges ; <span class="keyword">...</span>
0042                           zeros(1,size(obj.edges, 2))];
0043             obj.edges = [ obj.edges <span class="keyword">...</span>
0044                           zeros(length(obj.node_list),1)];
0045 
0046             obj.optimal_edges = [ obj.optimal_edges ; <span class="keyword">...</span>
0047                                 zeros(1, <span class="keyword">...</span>
0048                                       size(obj.optimal_edges,2 ))];
0049             obj.optimal_edges = [ obj.optimal_edges <span class="keyword">...</span>
0050                                 zeros(length(obj.node_list),1)];
0051         <span class="keyword">end</span>
0052 
0053 
0054         <a name="_sub3" href="#_subfunctions" class="code">function [m] = get_min_arriving_cost(obj, node_index)</a>
0055             A = obj.optimal_edges(:, node_index);
0056             A(~A) = inf;
0057             m = min(A);
0058             <span class="keyword">if</span> isinf(m)
0059                 m = 0;
0060             <span class="keyword">end</span>
0061         <span class="keyword">end</span>
0062 
0063 
0064         <a name="_sub4" href="#_subfunctions" class="code">function [obj] = append_node(obj, parent_node, new_node)</a>
0065         <span class="comment">% adds a new node to the graph object</span>
0066             obj.node_list = [obj.node_list new_node];
0067 
0068             obj = obj.increment_edges();
0069 
0070             <span class="comment">% update relation matrices</span>
0071             parent_index = obj.exists(parent_node);
0072             <span class="keyword">if</span> ~parent_index
0073                 display(<span class="string">'ERROR: parent is not in the node_list'</span>)
0074             <span class="keyword">end</span>
0075             obj.edges(parent_index, end) = 1;
0076 
0077             obj.optimal_edges(parent_index, end) = <span class="keyword">...</span>
0078                 obj.get_min_arriving_cost(parent_index) + <span class="keyword">...</span>
0079                 new_node.cost;
0080         <span class="keyword">end</span>
0081 
0082 
0083         <a name="_sub5" href="#_subfunctions" class="code">function [obj] = update_node(obj, parent_node, child_node, </a><span class="keyword">...</span>
0084                                      nnidx)
0085         <span class="comment">% updates relation of parent_node and child_node</span>
0086 
0087             pidx = obj.exists(parent_node);
0088 
0089             <span class="comment">% create link between parent and child</span>
0090             obj.edges(pidx, nnidx) = 1;
0091 
0092             obj.optimal_edges(pidx, nnidx) = <span class="keyword">...</span>
0093                 obj.get_min_arriving_cost(pidx) + <span class="keyword">...</span>
0094                 child_node.cost;
0095         <span class="keyword">end</span>
0096 
0097 
0098         <a name="_sub6" href="#_subfunctions" class="code">function [str] = get_factor_dim_string(obj, </a><span class="keyword">...</span>
0099                                                node_list_index)
0100             str = <span class="string">''</span>;
0101             first=1;
0102             <span class="keyword">for</span> find = 1: <span class="keyword">...</span>
0103                        length(obj.node_list(node_list_index) <span class="keyword">...</span>
0104                               .factors)
0105                 <span class="keyword">if</span> obj.node_list(node_list_index).factors(find).isLatent
0106                     <span class="keyword">if</span> ~first
0107                         str = [ str <span class="string">', '</span> ];
0108                     <span class="keyword">end</span>
0109                     first=0;
0110 
0111                     <span class="keyword">for</span> dind = length(<span class="keyword">...</span>
0112                         obj.node_list(node_list_index).factors(find) <span class="keyword">...</span>
0113                         .dims):-1:1
0114                         str = [ str <span class="keyword">...</span>
0115                                 char(obj.node_list(node_list_index) <span class="keyword">...</span>
0116                                      .factors(find).dims(dind).name) ];
0117                     <span class="keyword">end</span>
0118                 <span class="keyword">end</span>
0119             <span class="keyword">end</span>
0120         <span class="keyword">end</span>
0121 
0122 
0123         <a name="_sub7" href="#_subfunctions" class="code">function [str] = get_current_contraction_dims_string(obj, </a><span class="keyword">...</span>
0124                                                              node_list_index)
0125             str = <span class="string">''</span>;
0126             cont_dims = <span class="keyword">...</span>
0127                 obj.node_list(node_list_index) <span class="keyword">...</span>
0128                 .get_current_contraction_dims;
0129 
0130             <span class="keyword">for</span> cdi = 1:length(cont_dims)
0131                 str = [ str <span class="keyword">...</span>
0132                         char(cont_dims(cdi)) ];
0133             <span class="keyword">end</span>
0134         <span class="keyword">end</span>
0135 
0136 
0137         <a name="_sub8" href="#_subfunctions" class="code">function [str] = print_dot(obj)</a>
0138             str= [ <span class="string">'digraph structs{'</span> char(10) <span class="keyword">...</span>
0139                    <span class="string">'rankdir=LR;'</span> char(10) <span class="keyword">...</span>
0140                    <span class="string">'node [shape=Mrecord];'</span> char(10) <span class="keyword">...</span>
0141                    <span class="string">'splines=false '</span> char(10)];
0142 
0143             <span class="keyword">for</span> nid = 1:length(obj.node_list)
0144                 str = [ str <span class="string">'struct'</span> num2str(nid) <span class="string">' [label=&quot;&lt;f0&gt; '</span> <span class="keyword">...</span>
0145                         obj.get_current_contraction_dims_string(nid) <span class="keyword">...</span>
0146                         <span class="string">' | &lt;f1&gt; '</span> obj.get_factor_dim_string(nid) <span class="string">'&quot;];'</span> <span class="keyword">...</span>
0147                         char(10) 
0148                       ];
0149             <span class="keyword">end</span>
0150 
0151             <span class="keyword">for</span> i = 1:length(obj.edges)
0152                 <span class="keyword">for</span> j = 1:i
0153                     <span class="keyword">if</span> obj.edges(j,i)
0154                         str = [ str <span class="keyword">...</span>
0155                                 <span class="string">'struct'</span> num2str(j) <span class="string">':f0 -&gt;'</span> <span class="keyword">...</span>
0156                                 <span class="string">'struct'</span> num2str(i) <span class="string">':f0 '</span> <span class="keyword">...</span>
0157                                 <span class="string">'[ label=&quot;'</span> <span class="keyword">...</span>
0158                                 setdiff(obj <span class="keyword">...</span>
0159                                         .get_current_contraction_dims_string(i), <span class="keyword">...</span>
0160                                         obj.get_current_contraction_dims_string(j)) <span class="keyword">...</span>
0161                                 <span class="string">'('</span> num2str(obj.optimal_edges(j,i))  <span class="string">')&quot; ];'</span> char(10) ];
0162                     <span class="keyword">end</span>
0163                 <span class="keyword">end</span>
0164             <span class="keyword">end</span>
0165 
0166             str = [ str char(10) <span class="string">'}'</span> ];
0167 
0168         <span class="keyword">end</span>
0169 
0170 
0171     <span class="keyword">end</span>
0172 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 14-Aug-2012 15:00:33 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>